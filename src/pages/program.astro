---
import PageLayout from "../layouts/PageLayout.astro";
import Footer from "../components/Footer.astro";
import { getCollection, type CollectionEntry } from "astro:content";

type ProgramDay = {
  id: string;
  label: string;
  dateLabel?: string;
  summary?: string;
  order?: number;
  schedule?: ProgramItem[];
};

type ProgramItem = {
  time: string;
  title: string;
  location?: string;
  description?: string;
  banner?: string;
  poster?: string;
};

type ProgramEntry = CollectionEntry<"program">;

const programEntries: ProgramEntry[] = await getCollection("program");

const days = programEntries
  .map((entry) => entry.data as ProgramDay)
  .sort((a, b) => (a.order ?? 0) - (b.order ?? 0));

const pageTitle = "Program";
const dateRange = "12.–22. mars 2026";
const desc = "U.-KA. fyller Ålesund med konserter, show og opplevelser gjennom hele uka. Programmet oppdateres fortløpende.";

const formatCount = (count: number) => (count === 1 ? "1 arrangement" : `${count} arrangementer`);

const cloudName = import.meta.env.PUBLIC_CLOUDINARY_CLOUD_NAME;
const cloudUrl = (id: string, w = 800) =>
  `https://res.cloudinary.com/${cloudName}/image/upload/f_auto,q_auto,w_${w}/${id}`;

const typeFromTitle = (raw: string) => {
  const value = String(raw || "").toLowerCase();
  if (value.includes("konsert")) return "Konsert";
  if (value.includes("revy")) return "Revy";
  if (value.includes("show")) return "Show";
  if (value.includes("quiz")) return "Quiz";
  if (value.includes("film")) return "Film";
  if (value.includes("temakveld")) return "Temakveld";
  if (value.includes("bar-til-bar")) return "Sosial";
  if (value.includes("etterfest") || value.includes("fest")) return "Fest";
  if (value.includes("fisketur") || value.includes("tur")) return "Tur";
  if (value.includes("sport") || value.includes("idrett") || value.includes("challenge")) return "Sport";
  if (value.includes("foredrag")) return "Foredrag";
  if (value.includes("aktivitetsdag") || value.includes("aktivitet") || value.includes("familiedag")) return "Aktivitet";
  return "Opplevelse";
};

const accentForType = (type: string): string => {
  const v = type.toLowerCase();
  if (v === "konsert" || v === "fest") return "#f26f7a";
  if (v === "revy" || v === "show") return "#fdbc5b";
  if (v === "quiz" || v === "foredrag") return "#84d5f3";
  if (v === "aktivitet" || v === "sport" || v === "tur") return "#81c997";
  return "#fdbc5b";
};

const badgeClass = (type: string) => {
  const v = type.toLowerCase();
  if (v === "konsert" || v === "fest") return "bg-[#f26f7a] text-white";
  if (v === "revy" || v === "show") return "bg-[#fdbc5b] text-neutral-900";
  if (v === "quiz" || v === "foredrag") return "bg-[#84d5f3] text-neutral-900";
  if (v === "aktivitet" || v === "sport") return "bg-[#81c997] text-neutral-900";
  if (v === "tur") return "bg-[#84d5f3] text-neutral-900";
  if (v === "film" || v === "temakveld" || v === "sosial") return "bg-[#eadfd0] text-neutral-700";
  return "bg-neutral-100 text-neutral-700";
};
---

<PageLayout title={pageTitle} description={desc}>
  <div class="program-page">

    <!-- ── Hero ── -->
    <section class="relative mt-20 sm:mt-24">
      <div class="mx-auto max-w-6xl px-6 pt-10 sm:pt-14">
        <div class="relative overflow-hidden rounded-3xl bg-[#fdbc5b]">
          <div class="hero-dot-bg absolute inset-0 pointer-events-none" aria-hidden="true"></div>
          <div class="absolute -top-20 -right-20 h-72 w-72 rounded-full bg-[#f26f7a]/25 blur-3xl pointer-events-none" aria-hidden="true"></div>
          <div class="absolute -bottom-16 -left-16 h-56 w-56 rounded-full bg-[#81c997]/30 blur-3xl pointer-events-none" aria-hidden="true"></div>
          <div class="pointer-events-none absolute inset-3 rounded-2xl border border-white/25" aria-hidden="true"></div>
          <div class="hero-photo-panel absolute right-0 top-0 bottom-0 w-[44%] hidden lg:block" aria-hidden="true">
            <img src={cloudUrl("skiogmagi_2025_1_yweuhz", 1000)} alt="" class="w-full h-full object-cover" loading="eager" />
            <div class="absolute inset-0" style="background: linear-gradient(to right, #fdbc5b 0%, transparent 30%)"></div>
            <div class="absolute inset-0" style="background: linear-gradient(to top, #fdbc5b 0%, transparent 20%)"></div>
          </div>
          <div class="relative px-8 py-14 sm:px-12 sm:py-20 lg:max-w-[58%]">
            <span class="inline-flex items-center rounded-full bg-[#1b1b1b] px-4 py-1.5 text-xs font-bold uppercase tracking-[0.2em] text-white shadow-sm">U.-KA. 2026</span>
            <h1 class="mt-4 text-5xl font-extrabold tracking-tight text-[#1b1b1b] leading-[1.05] sm:text-6xl">{pageTitle}</h1>
            <p class="mt-3 text-lg font-semibold text-[#1b1b1b]/70">{dateRange}</p>
            <p class="mt-3 max-w-md text-[#1b1b1b]/60 leading-relaxed text-[0.95rem]">{desc}</p>
          </div>
        </div>
      </div>
    </section>

    <!-- ── Sticky day nav ── -->
    <nav class="day-nav-sticky" aria-label="Hopp til dato">
      <div class="mx-auto max-w-6xl px-6">
        <div class="day-strip">
          {days.map((day) => (
            <a href={`#${day.id}`} class="day-pill" data-day-link={day.id}>
              <span class="day-pill__date">{day.dateLabel ?? "TBA"}</span>
              <span class="day-pill__label">{day.label}</span>
            </a>
          ))}
        </div>
      </div>
    </nav>

    <!-- ── Program days ── -->
    <div class="mx-auto max-w-6xl px-6 pb-20 pt-6">
      <div class="space-y-16">
        {days.map((day) => {
          const events = day.schedule ?? [];
          return (
            <section id={day.id} class="day-section">
              <div class="day-header">
                <div>
                  <p class="day-header__label">{day.label}</p>
                  <h2 class="day-header__date">{day.dateLabel ?? "Dato kommer"}</h2>
                  {day.summary && <p class="day-header__summary">{day.summary}</p>}
                </div>
                <span class="day-count">{formatCount(events.length)}</span>
              </div>

              {events.length > 0 ? (
                <div class="day-grid">
                  {events.map((event) => {
                    const type = typeFromTitle(event.title);
                    const accent = accentForType(type);
                    return (
                      <article
                        class="event-card"
                        style={`--event-accent: ${accent}`}
                        data-ev-title={event.title}
                        data-ev-time={event.time || "TBA"}
                        data-ev-type={type}
                        data-ev-accent={accent}
                        data-ev-location={event.location || ""}
                        data-ev-desc={event.description || ""}
                        data-ev-banner={event.banner ? cloudUrl(event.banner, 1200) : ""}
                        data-ev-poster={event.poster ? cloudUrl(event.poster, 900) : ""}
                      >
                        <button type="button" class="event-card__open" aria-label={`Åpne ${event.title}`} data-open-event></button>

                        {event.banner && (
                          <div class="event-card__banner">
                            <img src={cloudUrl(event.banner, 700)} alt="" loading="lazy" draggable="false" />
                            <div class="event-card__banner-overlay"></div>
                          </div>
                        )}

                        <div class="event-card__bar"></div>

                        <div class="event-card__body">
                          <div class="event-card__row">
                            <span class={`event-tag ${badgeClass(type)}`}>{type}</span>
                            <span class="event-time">{event.time || "TBA"}</span>
                          </div>
                          <h3 class="event-card__title">{event.title}</h3>
                          {event.description && <p class="event-card__desc">{event.description}</p>}
                          <div class="event-card__meta">
                            {event.location && <span class="event-meta-pill">{event.location}</span>}
                            {event.poster && <span class="event-meta-pill event-meta-pill--poster">Plakat</span>}
                          </div>
                        </div>
                      </article>
                    );
                  })}
                </div>
              ) : (
                <p class="day-empty">Program kommer snart.</p>
              )}
            </section>
          );
        })}
      </div>
    </div>

    <!-- ── Event modal — dialog only, no wrapper div ── -->
    <dialog id="event-modal" class="event-modal" aria-labelledby="em-title">
      <div class="event-modal__panel">
        <div class="event-modal__bar" id="em-bar"></div>

        <div class="event-modal__banner-wrap" id="em-banner-wrap">
          <img id="em-banner" src="" alt="" draggable="false" />
          <div class="event-modal__banner-fade"></div>
        </div>

        <header class="event-modal__header">
          <div class="event-modal__header-meta">
            <span class="event-tag" id="em-type"></span>
            <span class="event-time" id="em-time"></span>
          </div>
          <div class="event-modal__header-row">
            <h3 id="em-title" class="event-modal__title"></h3>
            <button type="button" class="event-modal__close-x" aria-label="Lukk" data-close-event>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="size-5">
                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 0 1 1.414 0L10 8.586l4.293-4.293a1 1 0 1 1 1.414 1.414L11.414 10l4.293 4.293a1 1 0 0 1-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 0 1-1.414-1.414L8.586 10 4.293 5.707a1 1 0 0 1 0-1.414Z" clip-rule="evenodd" />
              </svg>
            </button>
          </div>
          <p class="event-modal__location" id="em-location"></p>
        </header>

        <div class="event-modal__body" id="em-body"></div>

        <footer class="event-modal__footer">
          <button type="button" class="event-modal__close-btn" data-close-event>Lukk</button>
        </footer>
      </div>
    </dialog>

    <Footer />
  </div>
</PageLayout>

<script is:inline>
  (function () {
    // Day nav active state
    const links = Array.from(document.querySelectorAll("[data-day-link]"));
    if (links.length) {
      const setActive = () => {
        const current = (location.hash || "").replace("#", "");
        links.forEach((link) => {
          const id = link.getAttribute("data-day-link");
          const active = Boolean(current && id === current);
          link.classList.toggle("is-active", active);
          active ? link.setAttribute("aria-current", "true") : link.removeAttribute("aria-current");
        });
      };
      setActive();
      window.addEventListener("hashchange", setActive);
    }

    // Event modal
    const dlg = document.getElementById("event-modal");
    if (!dlg) return;

    const bar        = document.getElementById("em-bar");
    const bannerWrap = document.getElementById("em-banner-wrap");
    const bannerImg  = document.getElementById("em-banner");
    const typeEl     = document.getElementById("em-type");
    const timeEl     = document.getElementById("em-time");
    const titleEl    = document.getElementById("em-title");
    const locationEl = document.getElementById("em-location");
    const bodyEl     = document.getElementById("em-body");

    const badgeCls = (type) => {
      const v = type.toLowerCase();
      if (v === "konsert" || v === "fest") return "bg-ev-pink";
      if (v === "revy"    || v === "show") return "bg-ev-yellow";
      if (v === "quiz"    || v === "foredrag") return "bg-ev-blue";
      if (v === "aktivitet" || v === "sport" || v === "tur") return "bg-ev-mint";
      if (v === "film" || v === "temakveld" || v === "sosial") return "bg-ev-sand";
      return "bg-ev-neutral";
    };

    const openModal = (data) => {
      if (bar) bar.style.background = data.accent;

      if (bannerWrap && bannerImg) {
        if (data.bannerUrl) {
          bannerImg.src = data.bannerUrl;
          bannerImg.alt = data.title;
          bannerWrap.hidden = false;
        } else {
          bannerWrap.hidden = true;
        }
      }

      if (typeEl) {
        typeEl.textContent = data.type;
        typeEl.className = "event-tag " + badgeCls(data.type);
      }
      if (timeEl) timeEl.textContent = data.time;
      if (titleEl) titleEl.textContent = data.title;
      if (locationEl) {
        locationEl.textContent = data.location;
        locationEl.hidden = !data.location;
      }

      if (bodyEl) {
        const descHtml = data.desc
          ? `<p class="em-desc">${data.desc.replace(/</g, "&lt;")}</p>`
          : "";
        if (data.posterUrl) {
          bodyEl.innerHTML = `
            <div class="em-content-grid">
              <div class="em-desc-col">${descHtml}</div>
              <div class="em-poster-col">
                <img class="em-poster-img" src="${data.posterUrl}" alt="${data.title.replace(/"/g,"&quot;")} plakat" draggable="false" />
              </div>
            </div>`;
        } else {
          bodyEl.innerHTML = descHtml;
        }
      }

      dlg.classList.remove("is-closing");
      try { dlg.showModal(); } catch { dlg.setAttribute("open", ""); }
    };

    const closeModal = () => {
      if (!dlg.hasAttribute("open")) return;
      dlg.classList.add("is-closing");
      setTimeout(() => {
        try { dlg.close(); } catch { dlg.removeAttribute("open"); }
        dlg.classList.remove("is-closing");
      }, 180);
    };

    // Open: click on the transparent card overlay
    document.addEventListener("click", (e) => {
      const btn = e.target.closest("[data-open-event]");
      if (!btn) return;
      e.stopPropagation();
      const card = btn.closest(".event-card");
      if (!card) return;
      const d = card.dataset;
      openModal({
        title:     d.evTitle    || "",
        time:      d.evTime     || "TBA",
        type:      d.evType     || "Opplevelse",
        accent:    d.evAccent   || "#fdbc5b",
        location:  d.evLocation || "",
        desc:      d.evDesc     || "",
        bannerUrl: d.evBanner   || "",
        posterUrl: d.evPoster   || "",
      });
    });

    // Close buttons (stop propagation so dlg click handler doesn't also fire)
    dlg.querySelectorAll("[data-close-event]").forEach((b) =>
      b.addEventListener("click", (e) => {
        e.stopPropagation();
        closeModal();
      })
    );

    // ESC key
    dlg.addEventListener("cancel", (e) => {
      e.preventDefault();
      closeModal();
    });

    // Backdrop: click on the <dialog> element itself (outside the panel)
    dlg.addEventListener("click", (e) => {
      if (e.target === dlg) closeModal();
    });
  })();
</script>

<style is:global>
  .program-page {
    background: #f7ecd8;
    min-height: 100svh;
    --program-anchor-offset: 130px;
  }

  .hero-dot-bg {
    background-image: radial-gradient(circle, rgba(27, 27, 27, 0.1) 1.5px, transparent 1.5px);
    background-size: 26px 26px;
  }

  /* Sticky nav */
  .day-nav-sticky {
    position: sticky;
    top: 62px;
    z-index: 40;
    background: rgba(247, 236, 216, 0.92);
    backdrop-filter: blur(14px);
    -webkit-backdrop-filter: blur(14px);
    border-bottom: 1px solid rgba(210, 175, 100, 0.35);
    padding: 0.55rem 0;
    margin-top: 1.25rem;
  }

  .day-strip {
    display: flex;
    gap: 0.4rem;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    padding: 0.2rem 0;
  }

  .day-pill {
    display: inline-flex;
    flex-direction: column;
    gap: 0.1rem;
    padding: 0.45rem 0.85rem;
    border-radius: 0.7rem;
    border: 1px solid transparent;
    background: transparent;
    color: #1b1b1b;
    text-decoration: none;
    scroll-snap-align: start;
    white-space: nowrap;
    transition: background 150ms ease, border-color 150ms ease;
  }

  .day-pill:hover {
    background: rgba(253, 188, 91, 0.3);
    border-color: rgba(253, 188, 91, 0.6);
  }

  .day-pill.is-active {
    background: #fdbc5b;
    border-color: #fdbc5b;
  }

  .day-pill__date {
    font-size: 0.875rem;
    font-weight: 800;
    line-height: 1.2;
  }

  .day-pill__label {
    font-size: 0.62rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    opacity: 0.55;
  }

  .day-section {
    scroll-margin-top: var(--program-anchor-offset);
  }

  .day-header {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 1rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #fdbc5b;
    margin-bottom: 1.5rem;
  }

  .day-header__label {
    font-size: 0.65rem;
    text-transform: uppercase;
    letter-spacing: 0.28em;
    font-weight: 700;
    color: #a07830;
  }

  .day-header__date {
    font-size: 2rem;
    font-weight: 800;
    color: #1b1b1b;
    line-height: 1.1;
    margin-top: 0.2rem;
  }

  @media (min-width: 640px) {
    .day-header__date { font-size: 2.5rem; }
  }

  .day-header__summary {
    margin-top: 0.3rem;
    font-size: 0.875rem;
    color: #7a5e30;
  }

  .day-count {
    flex-shrink: 0;
    font-size: 0.78rem;
    padding: 0.35rem 0.9rem;
    border-radius: 999px;
    background: #fdbc5b;
    color: #1b1b1b;
    font-weight: 700;
    white-space: nowrap;
  }

  .day-empty {
    font-size: 0.9rem;
    color: #a07830;
    font-style: italic;
    padding: 0.5rem 0;
  }

  .day-grid {
    display: grid;
    gap: 1.1rem;
    grid-template-columns: 1fr;
  }

  @media (min-width: 480px) {
    .day-grid { grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); }
  }

  @media (min-width: 1024px) {
    .day-grid { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
  }

  /* Event card */
  .event-card {
    position: relative;
    display: flex;
    flex-direction: column;
    border-radius: 1.25rem;
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.07);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    overflow: hidden;
    transition: transform 220ms ease, box-shadow 220ms ease;
    --event-accent: #fdbc5b;
    cursor: pointer;
  }

  .event-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 14px 36px rgba(0, 0, 0, 0.11);
  }

  .event-card__open {
    position: absolute;
    inset: 0;
    z-index: 10;
    background: transparent;
    border: 0;
    padding: 0;
    cursor: pointer;
  }

  .event-card__banner {
    position: relative;
    aspect-ratio: 16 / 9;
    overflow: hidden;
    flex-shrink: 0;
  }

  .event-card__banner img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: transform 400ms ease;
  }

  .event-card:hover .event-card__banner img {
    transform: scale(1.06);
  }

  .event-card__banner-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to bottom, transparent 45%, rgba(0, 0, 0, 0.35));
  }

  .event-card__bar {
    height: 3px;
    background: var(--event-accent);
    flex-shrink: 0;
  }

  .event-card__body {
    padding: 1.1rem 1.3rem 1.3rem;
    display: flex;
    flex-direction: column;
    flex: 1;
  }

  .event-card__row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 0.5rem;
  }

  .event-card__title {
    margin-top: 0.85rem;
    font-size: 1.15rem;
    font-weight: 800;
    line-height: 1.25;
    color: #1b1b1b;
  }

  @media (min-width: 640px) {
    .event-card__title { font-size: 1.25rem; }
  }

  .event-card__desc {
    margin-top: 0.45rem;
    font-size: 0.85rem;
    color: #555;
    line-height: 1.6;
  }

  .event-card__meta {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;
    margin-top: auto;
    padding-top: 1rem;
  }

  .event-tag {
    display: inline-flex;
    align-items: center;
    padding: 0.28rem 0.7rem;
    border-radius: 999px;
    font-size: 0.62rem;
    font-weight: 700;
    letter-spacing: 0.1em;
    text-transform: uppercase;
  }

  /* JS badge colours */
  .bg-ev-pink   { background: #f26f7a; color: white; }
  .bg-ev-yellow { background: #fdbc5b; color: #1b1b1b; }
  .bg-ev-blue   { background: #84d5f3; color: #1b1b1b; }
  .bg-ev-mint   { background: #81c997; color: #1b1b1b; }
  .bg-ev-sand   { background: #eadfd0; color: #555; }
  .bg-ev-neutral{ background: #f0f0f0; color: #555; }

  .event-time {
    font-size: 0.75rem;
    font-weight: 700;
    color: #7a5e30;
    white-space: nowrap;
  }

  .event-meta-pill {
    display: inline-flex;
    align-items: center;
    padding: 0.22rem 0.65rem;
    border-radius: 999px;
    background: #f7ecd8;
    color: #6b5030;
    font-size: 0.75rem;
    font-weight: 500;
  }

  .event-meta-pill--poster {
    background: #1b1b1b;
    color: #fff;
    font-size: 0.62rem;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-transform: uppercase;
  }

  /* ── Event modal ──
     Key: never override `display` on the <dialog> itself.
     The browser sets `display:none` when closed via the UA stylesheet.
     We only style what's visible when open.
  ── */
  .event-modal {
    padding: 1rem;
    border: 0;
    background: transparent;
    max-width: min(90vw, 52rem);
    max-height: 90dvh;
    width: 100%;
    overflow: visible;
  }

  .event-modal::backdrop {
    background: rgba(0, 0, 0, 0.6);
    backdrop-filter: blur(4px);
    -webkit-backdrop-filter: blur(4px);
  }

  /* Panel enter animation */
  .event-modal[open] .event-modal__panel {
    animation: em-in 0.2s ease both;
  }

  .event-modal.is-closing .event-modal__panel {
    animation: em-out 0.18s ease both;
  }

  @keyframes em-in {
    from { opacity: 0; transform: scale(0.96) translateY(10px); }
    to   { opacity: 1; transform: scale(1) translateY(0); }
  }

  @keyframes em-out {
    from { opacity: 1; transform: scale(1); }
    to   { opacity: 0; transform: scale(0.95) translateY(6px); }
  }

  .event-modal__panel {
    display: grid;
    grid-template-rows: auto auto auto 1fr auto;
    max-height: calc(90dvh - 2rem);
    border-radius: 1.5rem;
    background: white;
    box-shadow: 0 32px 80px rgba(0, 0, 0, 0.3);
    overflow: hidden;
  }

  .event-modal__bar {
    height: 4px;
    flex-shrink: 0;
  }

  .event-modal__banner-wrap {
    position: relative;
    aspect-ratio: 16 / 7;
    overflow: hidden;
    flex-shrink: 0;
  }

  .event-modal__banner-wrap img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .event-modal__banner-fade {
    position: absolute;
    inset: 0;
    background: linear-gradient(to bottom, transparent 40%, rgba(0,0,0,0.2));
  }

  .event-modal__header {
    padding: 1.25rem 1.5rem 0.75rem;
    border-bottom: 1px solid #f0ebe2;
  }

  .event-modal__header-meta {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    margin-bottom: 0.5rem;
  }

  .event-modal__header-row {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 1rem;
  }

  .event-modal__title {
    font-size: 1.4rem;
    font-weight: 800;
    color: #1b1b1b;
    line-height: 1.2;
  }

  @media (min-width: 640px) {
    .event-modal__title { font-size: 1.75rem; }
  }

  .event-modal__close-x {
    flex-shrink: 0;
    border: 0;
    background: transparent;
    padding: 0.3rem;
    color: #999;
    cursor: pointer;
    border-radius: 50%;
    transition: background 120ms, color 120ms;
    line-height: 0;
  }

  .event-modal__close-x:hover {
    background: #f3f3f3;
    color: #1b1b1b;
  }

  .event-modal__location {
    margin-top: 0.4rem;
    font-size: 0.82rem;
    color: #888;
    font-weight: 500;
  }

  .event-modal__body {
    padding: 1.25rem 1.5rem;
    overflow-y: auto;
    scrollbar-width: none;
    -ms-overflow-style: none;
  }

  .event-modal__body::-webkit-scrollbar { display: none; }

  .em-content-grid {
    display: grid;
    gap: 1.25rem;
    align-items: start;
  }

  @media (min-width: 560px) {
    .em-content-grid { grid-template-columns: 1fr auto; }
  }

  .em-desc {
    font-size: 0.95rem;
    color: #444;
    line-height: 1.7;
  }

  .em-poster-col {
    display: flex;
    justify-content: center;
  }

  .em-poster-img {
    display: block;
    width: min(160px, 38vw);
    border-radius: 0.6rem;
    box-shadow: 0 8px 28px rgba(0,0,0,0.22), 0 2px 6px rgba(0,0,0,0.1);
  }

  .event-modal__footer {
    display: flex;
    justify-content: flex-end;
    padding: 0.75rem 1.5rem;
    border-top: 1px solid #f0ebe2;
  }

  .event-modal__close-btn {
    border: 0;
    border-radius: 999px;
    background: #f0ebe2;
    color: #555;
    font-size: 0.875rem;
    font-weight: 600;
    padding: 0.5rem 1.4rem;
    cursor: pointer;
    transition: background 120ms;
  }

  .event-modal__close-btn:hover {
    background: #e5ddd0;
  }
</style>
